FROM node:18-bookworm-slim

# Install system dependencies

RUN apt-get update && \
    apt-get install -y vim curl unzip  bash zsh



RUN curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip" && \
    unzip awscliv2.zip && \
	./aws/install
RUN curl -LO https://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/linux/amd64/kubectl
RUN chmod +x ./kubectl
RUN mv ./kubectl /usr/local/bin


# Allow 'node' user to run sudo commands without a password

RUN echo 'node ALL=(ALL) NOPASSWD: ALL' >> /etc/sudoers



# Set the working directory inside the container

WORKDIR /app



# Copy package.json and yarn.lock files to the container

COPY package.json ./



# # Install dependencies

RUN yarn install --frozen-lockfile



# Copy the rest of the application files to the container

COPY . /app



# Expose the backend port

EXPOSE 7007

EXPOSE 3000



USER root

# Start the development server when the container is run

CMD ["yarn", "dev"]